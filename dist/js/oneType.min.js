var allShopList,oneType,username=location.href.split("?")[1],xhr1=new XMLHttpRequest;function loadShopList(e){var t=location.href.split("?")[1];allShopList=JSON.parse(this.response),oneType=allShopList[t],typeList(allShopList),createList(allShopList,typeTree),addEvery(kindList,oneType)}function typeList(e){for(var t=document.createElement("ul"),n=document.createElement("div"),i=2;i<e.length-1;i++){var o=document.createElement("li"),l=document.createElement("a");l.href="oneType.html?"+i,l.textContent=e[i][0].title,o.list=e[i],o.div=n,o.addEventListener("mouseover",screenList),o.appendChild(l),t.appendChild(o)}t.div=n,t.addEventListener("mouseleave",hideList),t.appendChild(n),allType.appendChild(t)}function screenList(e){for(var t=this.div.children.length,n=0;n<t;n++)this.div.firstElementChild.remove();this.div.style.display="block";var i=document.createElement("div"),o=document.createElement("h3");o.textContent=this.textContent;var l=document.createElement("ul");for(var r in this.list[1]){var d=document.createElement("li");d.textContent=this.list[1][r],l.appendChild(d)}var a=document.createElement("div"),s=document.createElement("h2");s.textContent="相关热门",a.appendChild(s);for(var h=3;h<this.list.length-1;h++){var p=document.createElement("a");for(var c in p.href="info.html?"+this.list[h].href,this.list[h])if("img"===c){var m=new Image;m.src="../"+this.list[h][c],p.appendChild(m)}else if("title"===c){var v=document.createElement("p");v.textContent=this.list[h][c],p.appendChild(v)}else if("price"===c){var u=document.createElement("span");u.textContent="售价"+this.list[h][c],p.appendChild(u)}a.appendChild(p)}i.appendChild(o),i.appendChild(l),this.div.appendChild(i),this.div.appendChild(a)}function hideList(e){this.div.style.display="none"}function logined(e){var t=new XMLHttpRequest;t.addEventListener("load",userLogin),t.open("POST","http://localhost:1026"),t.send(JSON.stringify(e))}function userLogin(e){var t=JSON.parse(this.response);t.isLogin?(loginTo.textContent=t.userObj,loginTo.href="",regTo.textContent="退出",regTo.href="",regTo.addEventListener("click",exitLogin)):(loginTo.textContent="登录",loginTo.href="html/login.html",regTo.removeEventListener("click",exitLogin),regTo.textContent="注册",regTo.href="html/regist.html")}function exitLogin(e){obj.exit=!0;var t=new XMLHttpRequest;t.addEventListener("load",userLogin),t.open("POST","http://localhost:1026"),t.send(JSON.stringify(obj))}function createList(e,t){for(var n=2;n<e.length-1;n++){console.log(e[n][0].title);var i=document.createElement("a");i.textContent=e[n][0].title,i.href="oneType.html?"+n,t.appendChild(i)}}function addEvery(e,t){for(var n=3;n<t.length;n++){var i=document.createElement("a");i.href="info.html?"+t[n].href;var o=document.createElement("li"),l=new Image;l.src="../"+t[n].img;var r=document.createElement("div");r.textContent=t[n].title;var d=document.createElement("div");d.textContent=t[n].price;var a=document.createElement("div");a.textContent="立即订购",o.appendChild(l),o.appendChild(r),o.appendChild(d),o.appendChild(a),i.appendChild(o),e.appendChild(i)}}xhr1.addEventListener("load",loadShopList),xhr1.open("get","../json/shopList.json"),xhr1.send(),obj={},logined(obj);