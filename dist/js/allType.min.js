var allShopList,xhr1=new XMLHttpRequest;function loadShopList(e){typeList(allShopList=JSON.parse(this.response)),findAll(allShopList,typeAll)}function typeList(e){for(var t=document.createElement("ul"),n=document.createElement("div"),i=2;i<e.length-1;i++){var l=document.createElement("li"),o=document.createElement("a");o.href="oneType.html?"+i,o.textContent=e[i][0].title,l.list=e[i],l.div=n,l.addEventListener("mouseover",screenList),l.appendChild(o),t.appendChild(l)}t.div=n,t.addEventListener("mouseleave",hideList),t.appendChild(n),allType.appendChild(t)}function screenList(e){for(var t=this.div.children.length,n=0;n<t;n++)this.div.firstElementChild.remove();this.div.style.display="block";var i=document.createElement("div"),l=document.createElement("h3");l.textContent=this.textContent;var o=document.createElement("ul");for(var d in this.list[1]){var r=document.createElement("li");r.textContent=this.list[1][d],o.appendChild(r)}var a=document.createElement("div"),s=document.createElement("h2");s.textContent="相关热门",a.appendChild(s);for(var h=3;h<this.list.length-1;h++){var p=document.createElement("a");for(var c in p.href="info.html?"+this.list[h].href,this.list[h])if("img"===c){var m=new Image;m.src="../"+this.list[h][c],p.appendChild(m)}else if("title"===c){var v=document.createElement("p");v.textContent=this.list[h][c],p.appendChild(v)}else if("price"===c){var u=document.createElement("span");u.textContent="售价"+this.list[h][c],p.appendChild(u)}a.appendChild(p)}i.appendChild(l),i.appendChild(o),this.div.appendChild(i),this.div.appendChild(a)}function hideList(e){this.div.style.display="none"}function findAll(e,t){console.log(e);for(var n=document.createElement("ul"),i=2;i<e.length-1;i++){var l=document.createElement("li"),o=document.createElement("a");o.textContent=e[i][0].title,o.href="oneType.html?"+i,l.appendChild(o);for(var d=0;d<e[i].length;d++)for(var r in e[i][d])if("title1"===r||"title2"===r||"title3"===r){var a=document.createElement("a");a.textContent=e[i][d][r],a.href="oneType.html?"+i+"&"+d,l.appendChild(a)}n.appendChild(l)}t.appendChild(n)}function logined(e){var t=new XMLHttpRequest;t.addEventListener("load",userLogin),t.open("POST","http://localhost:1026"),t.send(JSON.stringify(e))}function userLogin(e){var t=JSON.parse(this.response);t.isLogin?(loginTo.textContent=t.userObj,loginTo.href="",regTo.textContent="退出",regTo.href="",regTo.addEventListener("click",exitLogin)):(loginTo.textContent="登录",loginTo.href="html/login.html",regTo.removeEventListener("click",exitLogin),regTo.textContent="注册",regTo.href="html/regist.html")}function exitLogin(e){obj.exit=!0;var t=new XMLHttpRequest;t.addEventListener("load",userLogin),t.open("POST","http://localhost:1026"),t.send(JSON.stringify(obj))}xhr1.addEventListener("load",loadShopList),xhr1.open("get","../json/shopList.json"),xhr1.send(),obj={},logined(obj);