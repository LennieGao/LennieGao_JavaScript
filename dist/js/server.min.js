var userList=[],isLogin=!1,userObj="",areaPlace="",whereAera={area:""},reg=require("http"),server=reg.createServer(function(e,n){var o="";e.on("data",function(e){o+=e}),e.on("end",function(){for(var e=JSON.parse(o),r=0;r<userList.length;r++)userList[r].phoneNumber===e.phoneNumber?e.hasUser=!0:e.hasUser=!1;!0===e.hasUser||userList.push(e),console.log(userList),n.writeHead(200,{"Content-Type":"text/plain","Access-Control-Allow-Origin":"*"}),n.write(JSON.stringify(e)),n.end()})});server.listen(1024,"localhost",function(){console.log("注册服务开启，开始侦听")});var login=require("http"),server1=login.createServer(function(e,n){var o="";e.on("data",function(e){o+=e}),e.on("end",function(){for(var e=JSON.parse(o),r=0;r<userList.length;r++)userList[r].phoneNumber===e.phoneNumber&&userList[r].psd===e.psd?(userObj="",e.isUser=!0,isLogin=!0,userObj=e.phoneNumber,console.log(userObj)):(userObj="",e.isUser=!1,isLogin=!1);n.writeHead(200,{"Content-Type":"text/plain","Access-Control-Allow-Origin":"*"}),n.write(JSON.stringify(e)),n.end()})});server1.listen(1025,"localhost",function(){console.log("登录服务开启，开始侦听")});var logined=require("http"),server2=logined.createServer(function(e,r){var n="";e.on("data",function(e){n+=e}),e.on("end",function(){var e=JSON.parse(n);console.log(e),isLogin&&!e.exit?(e.isLogin=!0,e.userObj=userObj):(isLogin=!1,e.isLogin=!1,e.userObj=""),r.writeHead(200,{"Content-Type":"text/plain","Access-Control-Allow-Origin":"*"}),r.write(JSON.stringify(e)),r.end()})});server2.listen(1026,"localhost",function(){console.log("登录监听服务开启")});var area=require("http"),server3=area.createServer(function(e,r){var n="";e.on("data",function(e){n+=e}),e.on("end",function(){var e=JSON.parse(n);areaPlace=(e.area&&(whereAera.area=e.area),whereAera.area),r.writeHead(200,{"Content-Type":"text/plain","Access-Control-Allow-Origin":"*"}),r.write(areaPlace),r.end()})});server3.listen(1027,"localhost",function(){console.log("地区监听服务开启")});var shopData=[],shop=require("http"),server4=shop.createServer(function(e,t){var s="";e.on("data",function(e){s+=e}),e.on("end",function(){var e=JSON.parse(s);0===shopData.length&&shopData.push(e);for(var r=!1,n=0,o=0;o<shopData.length;o++)n=(e.idNum===shopData[o].idNum&&(r=!0),o);r?(shopData[n].num=e.num,shopData[n].sum=shopData[n].num*shopData[n].price):shopData.push(e),console.log(shopData[n]),t.writeHead(200,{"Content-Type":"text/plain","Access-Control-Allow-Origin":"*"}),t.write(JSON.stringify(e)),t.end()})});server4.listen(1028,"localhost",function(){console.log("购物车服务开启")});var createshop=require("http"),server5=createshop.createServer(function(e,r){var n="";e.on("data",function(e){n+=e}),e.on("end",function(){var e=JSON.parse(n);console.log(e),r.writeHead(200,{"Content-Type":"text/plain","Access-Control-Allow-Origin":"*"}),r.write(JSON.stringify(shopData)),r.end()})});server5.listen(1029,"localhost",function(){console.log("购物车创建服务开启")});